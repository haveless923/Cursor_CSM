# CSM 系统功能设计说明

## ✅ 已完成的前端功能

### 一、首页设计（Home.tsx）

- ✅ 3个主要模块卡片展示
  - 客户管理（蓝色主题）
  - 销售管理（绿色主题）
  - 销售AI（紫色主题）
- ✅ 每个模块显示子功能入口
- ✅ 快速统计面板（总客户数、待跟进、本月新增、结单数）
- ✅ 在线/离线状态显示

### 二、客户管理模块

#### 1. 客户列表页面（CustomerList.tsx）
- ✅ 支持5个分类：
  - 结单
  - 试用/谈判/高意向
  - 建联中
  - 公海（支持认领功能）
  - 静默
- ✅ 客户信息展示（客户姓名、到期、联系人、名称、状态等）
- ✅ 添加/编辑/删除客户
- ✅ 搜索功能
- ✅ 公海客户认领功能

### 三、销售管理模块

#### 1. 客户机会管理（OpportunityList.tsx）
- ✅ 新建客户机会
  - 客户名称
  - 项目名称
  - 项目链接
  - 备注
- ✅ 创建后自动到公海等待认领
- ✅ 机会列表展示
- ✅ 认领功能

#### 2. 拜访行程管理（VisitList.tsx）
- ✅ 创建行程单
  - 拜访日期
  - 拜访时间
  - 客户名称（关联客户）
  - 拜访地点
  - 拜访目的
  - 参与人员
  - 状态（待执行/已完成/已取消）
  - 备注
- ✅ 行程列表展示
- ✅ 状态筛选
- ✅ 搜索功能

### 四、销售AI模块

#### 1. 客户QA管理（QAList.tsx）
- ✅ 添加QA记录
  - 客户名称
  - 问题
  - 回答
  - 分类（产品功能/价格/技术支持/其他）
- ✅ QA列表展示
- ✅ 搜索功能

#### 2. 周报生成（ReportList.tsx）
- ✅ 周报列表展示
- ✅ 生成本周周报按钮
- ✅ 下载周报功能（待实现）
- ✅ 周报说明文档

## 📋 数据库设计（已更新）

### 新增表结构

1. **opportunities（销售机会表）**
   - id, customer_name, project_name, project_link, notes
   - status, owner_id, created_by
   - created_at, updated_at

2. **visits（拜访行程表）**
   - id, visit_date, visit_time, customer_id, customer_name
   - location, purpose, participants, notes, status
   - created_by, created_at, updated_at

3. **customer_qa（客户QA表）**
   - id, customer_id, customer_name
   - question, answer, category
   - created_by, created_at

### 更新的表

1. **customers（客户表）**
   - 新增字段：category（分类）、owner_id（负责人）、project_link（项目链接）、notes（备注）

## 🔧 待完成的工作

### 后端API开发

1. **客户管理API**
   - [ ] GET `/api/customers?category=xxx` - 按分类获取客户
   - [ ] POST `/api/customers` - 创建客户
   - [ ] PUT `/api/customers/:id` - 更新客户
   - [ ] DELETE `/api/customers/:id` - 删除客户
   - [ ] POST `/api/customers/:id/claim` - 认领客户

2. **销售机会API**
   - [ ] GET `/api/opportunities` - 获取机会列表
   - [ ] POST `/api/opportunities` - 创建机会（自动到公海）
   - [ ] PUT `/api/opportunities/:id` - 更新机会
   - [ ] DELETE `/api/opportunities/:id` - 删除机会
   - [ ] POST `/api/opportunities/:id/claim` - 认领机会

3. **拜访行程API**
   - [ ] GET `/api/visits` - 获取行程列表
   - [ ] POST `/api/visits` - 创建行程
   - [ ] PUT `/api/visits/:id` - 更新行程
   - [ ] DELETE `/api/visits/:id` - 删除行程

4. **客户QA API**
   - [ ] GET `/api/qa` - 获取QA列表
   - [ ] POST `/api/qa` - 创建QA
   - [ ] PUT `/api/qa/:id` - 更新QA
   - [ ] DELETE `/api/qa/:id` - 删除QA

5. **周报API**
   - [ ] GET `/api/reports` - 获取周报列表
   - [ ] POST `/api/reports/generate` - 生成周报
   - [ ] GET `/api/reports/:id/download` - 下载周报

### 前端服务层

1. **创建服务文件**
   - [ ] `client/src/services/opportunities.ts`
   - [ ] `client/src/services/visits.ts`
   - [ ] `client/src/services/qa.ts`
   - [ ] `client/src/services/reports.ts`

2. **更新客户服务**
   - [ ] 支持按分类查询
   - [ ] 支持认领功能

### 功能完善

1. **统计功能**
   - [ ] 首页统计数据API
   - [ ] 实时更新统计数据

2. **周报生成逻辑**
   - [ ] 数据汇总算法
   - [ ] QA分析算法
   - [ ] 报告模板设计
   - [ ] 导出功能（Excel/PDF）

3. **权限管理**
   - [ ] 不同角色权限控制
   - [ ] 数据可见性控制

## 🎯 使用说明

### 访问路径

- **首页**: `/`
- **客户管理**:
  - `/customer/结单`
  - `/customer/试用/谈判/高意向`
  - `/customer/建联中`
  - `/customer/公海`
  - `/customer/静默`
- **销售管理**:
  - `/sales/opportunity` - 客户机会
  - `/sales/visit` - 拜访行程
- **销售AI**:
  - `/ai/qa` - 客户QA
  - `/ai/report` - 周报生成

### 工作流程

1. **销售助理创建机会**
   - 进入"销售管理" → "新建客户机会"
   - 填写客户信息、项目信息、链接、备注
   - 创建后自动到"客户管理" → "公海"

2. **销售认领机会**
   - 进入"客户管理" → "公海"
   - 查看未认领的客户机会
   - 点击"认领"按钮

3. **创建拜访行程**
   - 进入"销售管理" → "拜访行程"
   - 创建行程并与客户关联
   - 团队内可查看所有行程

4. **记录客户QA**
   - 进入"销售AI" → "客户QA"
   - 记录常见问题和回答
   - 用于后续参考和数据分析

5. **生成周报**
   - 进入"销售AI" → "周报生成"
   - 点击"生成本周周报"
   - 系统自动汇总数据并生成报告

## 📝 注意事项

1. **数据库迁移**
   - 需要运行数据库初始化脚本更新表结构
   - 现有数据需要迁移到新结构

2. **API对接**
   - 前端页面已创建，但API调用部分标记为TODO
   - 需要完成后端API后对接

3. **数据同步**
   - 保持现有的离线/在线同步机制
   - 新功能也需要支持离线编辑

## 🚀 下一步

1. 完成后端API开发
2. 对接前端服务层
3. 实现周报生成逻辑
4. 添加数据统计功能
5. 完善权限管理




